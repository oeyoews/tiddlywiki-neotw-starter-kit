{
    "title": "$:/plugins/oeyoews/neotw-copy-code",
    "description": "Neotw Copy Code",
    "author": "oeyoews",
    "version": "0.0.2",
    "core-version": ">=5.2.5",
    "type": "application/json",
    "plugin-type": "plugin",
    "name": "Neotw Copy Code",
    "dependents": "$:/plugins/oeyoews/tiddlywiki-tailwindcss-plus",
    "list": "readme explore",
    "text": "{\"tiddlers\":{\"$:/plugins/oeyoews/neotw-copy-code/Layout\":{\"title\":\"$:/plugins/oeyoews/neotw-copy-code/Layout\",\"tags\":\"$:/tags/Layout\",\"name\":\"{{$:/plugins/oeyoews/neotw-copy-code/icon}} Neotw Copy Code\",\"description\":\"{{$:/plugins/oeyoews/neotw-copy-code/readme!!description}}\",\"text\":\"\\\\import [[$:/core/ui/PageMacros]] [all[shadows+tiddlers]tag[$:/tags/Macro]!has[draft.of]]\\n\\n<$vars\\n  tv-config-toolbar-icons={{$:/config/Toolbar/Icons}}\\n  tv-config-toolbar-text={{$:/config/Toolbar/Text}}\\n  tv-config-toolbar-class={{$:/config/Toolbar/ButtonClass}}\\n  tv-enable-drag-and-drop={{$:/config/DragAndDrop/Enable}}\\n  tv-show-missing-links={{$:/config/MissingLinks}}\\n  storyviewTitle={{$:/view}}\\n  languageTitle={{{ [{$:/language}get[name]] }}}>\\n\\n<div class=\\\"prose max-w-none prose-indigo m-auto sm:w-auto md:w-2/3\\\">\\n{{{ [[$:/plugins/oeyoews/neotw-copy-code/readme]] ||$:/core/ui/ViewTemplate }}}\\n</div>\"},\"$:/plugins/oeyoews/neotw-copy-code/readme\":{\"title\":\"$:/plugins/oeyoews/neotw-copy-code/readme\",\"description\":\"~Copy Code\",\"text\":\"<div class=\\\"prose max-w-none prose-indigo\\\">\\n\\n!! Neotw Copy Code\\n\\n* [[Source|https://github.com/oeyoews/neotw/tree/main/plugins/oeyoews/neotw-copy-code]]\\n* [[Demo|https://oeyoews.github.io/neotw]]\\n\\nThis plugin is designed to add a copy code button to code blocks in TiddlyWiki, making it easier to copy code snippets with their formatting and indentation intact. In TiddlyWiki, code blocks are typically wrapped in the `<pre>` tag to preserve their formatting and indentation. However, copying the code manually can be inconvenient.\\n\\nThis plugin solves this problem by adding a ‚ÄúCopy Code‚Äù button next to the code block. Clicking the button copies the code to the clipboard, and the copied code is also displayed in a popup using the SweetAlert2 plugin, making it easy to verify that the code was copied successfully.\\n\\nThis plugin can greatly improve the efficiency and convenience of displaying and sharing code in TiddlyWiki, especially when you need to copy code frequently.\\n\\nThe only downside at the moment is that the copy button needs to be manually triggered for display.\\n\\n!! Example\\n\\n<$button message=\\\"om-copy-code\\\" >\\n<$action-sendmessage $message=\\\"om-confetti-launch\\\" />\\n<$action-sendmessage $message=\\\"om-sound\\\" />\\n{{$:/plugins/oeyoews/neotw-copy-code/icon}} Click to show copy code button\\n</$button>\\n\\n```python\\n# Hello World program in Python\\nprint(\\\"Hello, World!\\\")\\n```\\n\\n```java\\n// Hello World program in Java\\npublic class HelloWorld {\\n    public static void main(String[] args) {\\n        System.out.println(\\\"Hello, World!\\\");\\n    }\\n}\\n```\\n\\n```javascript\\n// Hello World program in JavaScript\\nconsole.log(\\\"Hello, World!\\\");\\n```\\n\\n```c\\n/* Hello World program in C */\\n#include <stdio.h>\\nint main() {\\n    printf(\\\"Hello, World!\\\");\\n    return 0;\\n}\\n```\\n\\n```cpp\\n// Hello World program in C++\\n#include <iostream>\\nint main() {\\n    std::cout << \\\"Hello, World!\\\";\\n    return 0;\\n}\\n```\\n\\n```ruby\\n# Hello World program in Ruby\\nputs \\\"Hello, World!\\\"\\n```\\n\\n```php\\n<?php\\n// Hello World program in PHP\\necho \\\"Hello, World!\\\";\\n?>\\n```\\n\\n```swift\\n// Hello World program in Swift\\nprint(\\\"Hello, World!\\\")\\n```\\n\\n```go\\n// Hello World program in Go\\npackage main\\nimport \\\"fmt\\\"\\nfunc main() {\\n    fmt.Println(\\\"Hello, World!\\\")\\n}\\n```\\n\\n```kotlin\\n// Hello World program in Kotlin\\nfun main() {\\n    println(\\\"Hello, World!\\\")\\n}\\n```\\n\\n!! TODO\\n\\n<!-- * update copied icon -->\\n<!-- * add viewtoolbar not pagecontrol -->\\n<!-- * support hover scroll for code preview -->\\n<!-- * update style for button -->\\n<!-- * add hover style -->\\n* make preview is optional\\n* add transform style\\n* update plugin dependencies\\n* float right modify too long code view when hover\\n\\n* copy code to image\\n* support copy image to clipboard\\n\\n!! Performace\\n\\n* lazy load button\\n\\n</div>\\n\"},\"$:/plugins/oeyoews/neotw-copy-code/copyCode.js\":{\"title\":\"$:/plugins/oeyoews/neotw-copy-code/copyCode.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/neotw-copy-code/copyCode.js\\ntype: application/javascript\\nmodule-type: library\\n\\neotw-copy-code widget\\n\\n\\\\*/\\nfunction addCopyButton() {\\n  const codeBlocks = document.querySelectorAll('pre');\\n\\n  codeBlocks.forEach(codeBlock => {\\n    const existingButton = codeBlock.querySelector('.copy-button');\\n    const codeElement = codeBlock.querySelector('code');\\n    // const cloneCodeElement = codeElement.cloneNode(true);\\n    // const fileType = codeElement?.className.split(' ')[0] ?? null; // get file type from first class name default ??\\n    const regex = /language-(\\\\w+)/;\\n    const match = codeElement?.className?.match(regex);\\n    const fileType = match ? match[1] : null;\\n\\n    // use hidden ???\\n    const showButton = buttonStatus => {\\n      codeBlock.addEventListener('mouseenter', () => {\\n        buttonStatus.classList.remove('hidden');\\n        buttonStatus.classList.add('block');\\n      });\\n\\n      codeBlock.addEventListener('mouseleave', () => {\\n        buttonStatus.classList.remove('block');\\n        buttonStatus.classList.add('hidden');\\n      });\\n    };\\n    // ??\\n    if (existingButton && codeElement) {\\n      // to remove not hidden because of new codeblocks should add new copy button if dom has new pre>code\\n      // existingButton.remove();\\n      // TODO: need remove addEventListener ???\\n      // TODO transition hidden\\n      showButton(existingButton);\\n    } else {\\n      // TODO: option this hidden or not\\n      classNames =\\n        'copy-button float-right hover:bg-gray-200 transition duration-200 hidden ease-in'; //  opacity-0 hover:opacity-100\\n      const copyButton = $tw.utils.domMaker('button', {\\n        text: fileType ? `${fileType} üìã` : 'üìã',\\n        class: fileType ? classNames : classNames + ' -m-4',\\n        attributes: {\\n          title: '',\\n        },\\n      });\\n\\n      showButton(copyButton);\\n\\n      const notify = () => {\\n        Swal.fire({\\n          title: `Copied to clipboard`,\\n          icon: 'success',\\n          toast: true,\\n          showCancelButton: false,\\n          showConfirmButton: false,\\n          timer: 1500,\\n          position: 'top-end',\\n        });\\n      };\\n\\n      copyButton.addEventListener('click', () => {\\n        navigator.clipboard\\n          .writeText(codeElement.textContent)\\n          .then(() => {\\n            if (typeof Swal?.fire === 'function') {\\n              notify();\\n            } else {\\n              copyButton.textContent = '‚úÖ Copied!';\\n              setTimeout(() => {\\n                copyButton.textContent = fileType ? `${fileType} üìã` : 'üìã';\\n              }, 1000);\\n            }\\n          })\\n          .catch(err => {\\n            console.log(err);\\n          });\\n\\n        /**\\n         * preview\\n         *\\n         */\\n        /* if (isSuccess) {\\n          // confetti();\\n          // howler();\\n\\n          const container = document.createElement('div');\\n          container.classList.add('max-w-full', 'overflow-auto'); // Ê∑ªÂä†ÈÄÇÂΩìÁöÑÂÆπÂô®Ê†∑Âºè\\n\\n          const copiedCodeNode = document.createElement('pre');\\n          copiedCodeNode.appendChild(cloneCodeElement);\\n          copiedCodeNode.classList.add(\\n            'bg-gray-200',\\n            'shadow-sm',\\n            'p-0',\\n            'rounded',\\n            'text-base',\\n            'font-mono',\\n            'leading-relaxed',\\n            'text-left',\\n            'overflow-x-auto',\\n            'whitespace-pre-wrap',\\n            'border',\\n            'border-none',\\n            'break-words',\\n            'max-h-48', // Ê∑ªÂä†ÊúÄÂ§ßÈ´òÂ∫¶ÈôêÂà∂Ôºå‰æãÂ¶Ç48ÂÉèÁ¥†\\n          );\\n          container.appendChild(copiedCodeNode);\\n          // TODO: add preview option configuration\\n        */\\n      });\\n      codeElement?.parentNode?.insertBefore(copyButton, codeElement);\\n    }\\n  });\\n}\\n\\nmodule.exports = {\\n  addCopyButton,\\n};\\n\",\"type\":\"application/javascript\",\"module-type\":\"library\"},\"$:/plugins/oeyoews/neotw-copy-code/icon\":{\"title\":\"$:/plugins/oeyoews/neotw-copy-code/icon\",\"text\":\"<svg width=\\\"22pt\\\" height=\\\"22pt\\\" class=\\\"tc-image-zwi-clipboard tc-image-button\\\" viewBox=\\\"0 0 24 24\\\"><g fill=\\\"none\\\" fill-rule=\\\"evenodd\\\"><path fill=\\\"#000\\\" fill-rule=\\\"nonzero\\\" d=\\\"M10,4.5 C10,4.77614237 9.77614237,5 9.5,5 C9.22385763,5 9,4.77614237 9,4.5 C9,3.67157288 9.67157288,3 10.5,3 L13.5,3 C14.3284271,3 15,3.67157288 15,4.5 C15,4.77614237 14.7761424,5 14.5,5 C14.2238576,5 14,4.77614237 14,4.5 C14,4.22385763 13.7761424,4 13.5,4 L10.5,4 C10.2238576,4 10,4.22385763 10,4.5 Z M7.5,4 C7.77614237,4 8,4.22385763 8,4.5 C8,4.77614237 7.77614237,5 7.5,5 C6.67157288,5 6,5.67157288 6,6.5 L6,18.5 C6,19.3284271 6.67157288,20 7.5,20 L16.5,20 C17.3284271,20 18,19.3284271 18,18.5 L18,6.5 C18,5.67157288 17.3284271,5 16.5,5 C16.2238576,5 16,4.77614237 16,4.5 C16,4.22385763 16.2238576,4 16.5,4 C17.8807119,4 19,5.11928813 19,6.5 L19,18.5 C19,19.8807119 17.8807119,21 16.5,21 L7.5,21 C6.11928813,21 5,19.8807119 5,18.5 L5,6.5 C5,5.11928813 6.11928813,4 7.5,4 Z\\\"/><path fill=\\\"#000\\\" fill-rule=\\\"nonzero\\\" d=\\\"M8.5 10C8.22385763 10 8 9.77614237 8 9.5 8 9.22385763 8.22385763 9 8.5 9L15.5 9C15.7761424 9 16 9.22385763 16 9.5 16 9.77614237 15.7761424 10 15.5 10L8.5 10zM8.5 13C8.22385763 13 8 12.7761424 8 12.5 8 12.2238576 8.22385763 12 8.5 12L15.5 12C15.7761424 12 16 12.2238576 16 12.5 16 12.7761424 15.7761424 13 15.5 13L8.5 13zM8.5 16C8.22385763 16 8 15.7761424 8 15.5 8 15.2238576 8.22385763 15 8.5 15L13.5 15C13.7761424 15 14 15.2238576 14 15.5 14 15.7761424 13.7761424 16 13.5 16L8.5 16z\\\"/></g></svg>\\n\",\"type\":\"text/vnd.tiddlywiki\"},\"$:/plugins/oeyoews/neotw-copy-code/snippets/neotw-copy-code\":{\"title\":\"$:/plugins/oeyoews/neotw-copy-code/snippets/neotw-copy-code\",\"caption\":\"neotw-copy-code Widget\",\"description\":\"Neotw Copy Code Widget\",\"tags\":\"$:/tags/TextEditor/Snippet\"},\"copyButton/startup.js\":{\"title\":\"copyButton/startup.js\",\"text\":\"/*\\\\\\ntitle: copyButton/startup.js\\ntype: application/javascript\\nmodule-type: startup\\n\\ncopyButton module\\n\\n\\\\*/\\n(function () {\\n  /*jslint node: true, browser: true */\\n  /*global $tw: false */\\n  'use strict';\\n\\n  exports.name = 'copyButton-startup-hook';\\n  exports.platforms = ['browser'];\\n  exports.after = ['startup'];\\n  exports.synchronous = true;\\n  exports.startup = () => {\\n    const {\\n      addCopyButton,\\n    } = require('$:/plugins/oeyoews/neotw-copy-code/copyCode.js');\\n    // window.copyButton = addCopyButton;\\n    $tw.rootWidget.addEventListener('om-copy-code', () => {\\n      addCopyButton();\\n      Swal.fire({\\n        title: `Enable copy code`,\\n        icon: 'success',\\n        toast: true,\\n        showCancelButton: false,\\n        showConfirmButton: false,\\n        timer: 1500,\\n        position: 'top-end',\\n      });\\n    });\\n  };\\n})();\\n\",\"type\":\"application/javascript\",\"module-type\":\"startup\"},\"$:/plugins/oeyoews/neotw-copy-code/ui\":{\"title\":\"$:/plugins/oeyoews/neotw-copy-code/ui\",\"tags\":\"$:/tags/PageControls\",\"list-before\":\"\",\"description\":\"copy code button\",\"caption\":\"Copy Button\",\"text\":\"\\\\whitespace trim\\n<$button message=\\\"om-copy-code\\\" tooltip=\\\"Copy Code\\\" aria-label=\\\"copy\\\" class=<<tv-config-toolbar-class>>>\\n<!-- <$action-sendmessage $message=\\\"om-confetti-launch\\\"/> -->\\n<!-- <$action-sendmessage $message=\\\"om-sound\\\"/> -->\\n<$list filter=\\\"[<tv-config-toolbar-icons>match[yes]]\\\">\\n{{$:/plugins/oeyoews/neotw-copy-code/icon}}\\n</$list>\\n<$list filter=\\\"[<tv-config-toolbar-text>match[yes]]\\\">\\n<span class=\\\"tc-btn-text\\\">\\n<$text text=\\\"Copy\\\"/>\\n</span>\\n</$list>\\n</$button>\\n\"}}}"
}